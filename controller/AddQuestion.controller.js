sap.ui.define(["learninggame/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast"],function(e,t,n){"use strict";return e.extend("learninggame.controller.AddQuestion",{onInit:function(){this._oGameSettings=this.getOwnerComponent().getModel("GameSettings");this._nextID=1;const e=new t;e.loadData("/model/FioriQuestions.json");e.attachRequestCompleted(()=>{const t=e.getData();if(t&&Array.isArray(t.results)&&t.results.length>0){const e=t.results.reduce((e,t)=>{const n=Number(t.QuestionID)||0;return n>e?n:e},0);this._nextID=e+1}else{this._nextID=1}n.show(`Nächste QuestionID: ${this._nextID}`)});e.attachRequestFailed(()=>{this._nextID=1})},_getInputValue:function(e){const t=this.byId(e);return t?t.getValue?t.getValue().trim():"":""},_getChecked:function(e){const t=this.byId(e);return t?!!t.getSelected&&t.getSelected():false},onGenerateJSON:function(){const e=this._getInputValue("inpQuestionText");if(!e){n.show("Bitte erst den Fragetext eingeben.");return}const t=["A","B","C","D","E","F"];const s=t.map(e=>({key:e,text:this._getInputValue("inp"+e),correct:this._getChecked("chk"+e)}));const o=s.filter(e=>e.text&&e.text.length>0);const i=this.byId("selTopic");const r=i?i.getSelectedKey()||i.getSelectedItem&&i.getSelectedItem().getText()||"":"";const c={QuestionID:this._nextID,QuestionText:e,AmountOfTrueAnswers:o.filter(e=>e.correct).length,QuestionTopicArea:r||""};t.forEach(e=>{const t=s.find(t=>t.key===e);c["Answer"+e]=t&&t.text?t.text:"";c["Answer"+e+"_boolean"]=!!(t&&t.correct)});const l=JSON.stringify(c,null,4);this.byId("txtResult").setValue(l);n.show(`JSON für QuestionID ${this._nextID} erstellt.`);this._nextID++},onDownloadJSON:function(){const e=this.byId("txtResult").getValue();if(!e){n.show("Keine JSON-Daten zum Herunterladen. Bitte zuerst generieren.");return}const t=new Blob([e],{type:"application/json"});const s=URL.createObjectURL(t);const o=document.createElement("a");o.href=s;o.download=`Question-${Date.now()}.json`;document.body.appendChild(o);o.click();document.body.removeChild(o);URL.revokeObjectURL(s)}})});
//# sourceMappingURL=AddQuestion.controller.js.map